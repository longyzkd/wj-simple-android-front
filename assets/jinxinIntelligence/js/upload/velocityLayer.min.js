!function(e){"object"==typeof module&&"object"==typeof module.exports?module.exports=e():"function"==typeof define&&define.amd?define(e):e()}(function(){return function(e,t,n,a){function i(e,t){for(var n,a=0,i=0;i<e.length;i++)e[i]==t&&a++;for(var i=0;a>i;i++)n=e.indexOf(t),n>-1&&e.splice(n,1);return e}var o=e,r={index:1,zIndex:999999,prefix:"velocityLayer-",blurTarget:"velocityLayer-container",screenWidth:t.screen.width,screenHeight:t.screen.height,winScrollTop:0},l=r.Data={layer:{},form:[],alert:[],confirm:[],tip:[],blur:[r.blurTarget]},c=r.Tool={clearForeLayer:function(e){if(l[e])for(var t=0;t<l[e].length;t++)l.layer[l[e][t]]&&l.layer[l[e][t]].close&&l.layer[l[e][t]].close(),c.removeLayer(l[e][t],e)},addLayer:function(e,t){e&&l[t]&&-1==l[t].indexOf(e)&&l[t].push(e)},removeLayer:function(e,t){i(l[t],e)},setBone:function(e){function t(){var e;return e=r.loading?'<div class="velocityLayerLoading"><div class="velocityLayerLoadingPanel"><div class="velocityLayerLoadingPannelInner"><div class="velocityLayerLoadingFg"><div class="velocityLayerLoadingBall"></div></div></div></div></div>':""}function n(){var e;return e=r.layerBg?'<div id="velocityLayerBg_'+r.zIndex+'" class="velocityLayerBg " style="background-color:'+r.layerBgColor+';"></div>':""}function a(){var e,t;return r.boxBg?(t=r.boxBgBlur?" velocityLayerBlur ":"",e='<div id="velocityLayerBoxBg_'+r.zIndex+'" class="velocityLayerBoxBg" style="background-color:'+r.boxBgColor+';"></div>'):e="",e}var i,r=e.OPTIONS;r.layerHeight,i="";var l='<div class="velocityLayer '+r.globalClass+'" '+i+">"+n()+t()+'<div class="velocityLayerOutter"><div class="velocityLayerInner"><div class="velocityLayerBox">'+a()+'<div class="velocityLayerBoxInner"></div></div></div></div></div>';return o(l)}},s={title:"操作提示",msg:"",zIndex:r.zIndex,tmplId:"",Dom:"",tmplData:{},showHead:!0,hide:!1,loading:!0,layerBg:!0,layerBgBlur:!0,layerBgColor:"rgba(0, 0, 0, 0.35)",boxBg:!1,boxBgBlur:!1,boxBgColor:"rgba(255, 255, 255, 0.80)",effectTime:250,effectClass:{},delayTime:500,layerHeight:!0,unique:!1,loadingAutoComplete:!0,insertBeforeFun:function(e){},insertAfterFun:function(e){},OKFun:function(e){},CancelFun:function(e){}};o.Velocity.RegisterEffect("transition.flipXIn",{defaultDuration:s.effectTime,calls:[[{opacity:1,rotateY:[0,-55]}]]}).RegisterEffect("transition.flipXOut",{defaultDuration:s.effectTime,calls:[[{opacity:0,rotateY:55}]],reset:{rotateY:0}}).RegisterEffect("transition.bounceInRight",{defaultDuration:s.effectTime,calls:[[{opacity:.5,translateX:"-30px"}],[{opacity:1,translateX:"10px"}],[{opacity:1,translateX:"0"}]]}).RegisterEffect("transition.bounceOutRight",{defaultDuration:s.effectTime,calls:[[{opacity:1,translateX:"0px"}],[{opacity:0,translateX:"100%"}]]}).RegisterEffect("transition.bounceIn",{defaultDuration:s.effectTime,calls:[[{opacity:0,scale:"0.3"}],[{opacity:1,scale:"1.05"}],[{opacity:1,scale:"0.9"}],[{opacity:1,scale:"1"}]]}).RegisterEffect("transition.fadeOut",{defaultDuration:s.effectTime,calls:[[{opacity:1}],[{opacity:0}]]}).RegisterEffect("transition.bounceInDown",{defaultDuration:s.effectTime,calls:[[{opacity:0,translateY:"-100%"}],[{opacity:1,translateY:"0px"}]]}).RegisterEffect("transition.bounceOutUp",{defaultDuration:s.effectTime,calls:[[{opacity:1,translateY:"0"}],[{opacity:0,translateY:"-100%"}]]}).RegisterEffect("transition.bounceInUp",{defaultDuration:s.effectTime,calls:[[{opacity:0,translateY:"100%"}],[{opacity:.5,translateY:"-30px"}],[{opacity:1,translateY:"-10px"}],[{opacity:1,translateY:"0"}]]}).RegisterEffect("transition.bounceOutDown",{defaultDuration:s.effectTime,calls:[[{opacity:1,translateY:"0"}],[{opacity:.5,translateY:"-20px"}],[{opacity:0,translateY:"-100%"}]]});var u=function(e){var n=this,a=o.extend({},s);e=o.extend(a,e),n.initialize=function(){n.OPTIONS=e||{},n.OPTIONS.unique&&c.clearForeLayer(n.OPTIONS.type),n.initBone(),c.addLayer(n.VL.attr("id"),n.OPTIONS.type),l.layer[n.VL.attr("id")]=n},n.initBone=function(){var a;a=c.setBone(n),e.no_padding&&a.addClass("no_padding"),n.VL=a,n.CLOutter=o(".velocityLayerOutter",a),n.CLBg=o(".velocityLayerBg",a),n.CLBoxInner=o(".velocityLayerBoxInner",a),a.attr("id",r.prefix+r.index).css({"z-index":parseInt(e.zIndex)+parseInt(r.index)}),e.insertBeforeFun&&e.insertBeforeFun instanceof Function&&e.insertBeforeFun(n),n.initDom(),n.insertTmplDom(),n.CLBodyInner=o(".velocityLayerBodyInner",a),n.CLOK=o(".velocityLayerOK",a),n.CLCancel=o(".velocityLayerCancel",a),o("body").append(a),e.insertAfterFun&&e.insertAfterFun instanceof Function&&e.insertAfterFun(n),n.setValues(),o(t).bind("resize",function(){n.setValues()}),n.onEvents(),n.show(),n.autoClear(),r.index++},n.initDom=function(){n.setHead(),n.setBody(),n.setFoot()},n.setBlur=function(){e.layerBgBlur&&(n.target=o("#"+l.blur[l.blur.length-1]),n.target&&n.target.get(0)&&(1==l.blur.length?n.target.attr("winScrollTop",o(t).scrollTop()):n.target.attr("windowScrollTop",o(".velocityLayerContainer",n.target).scrollTop()),n.target.addClass("velocityLayerBlur")))},n.clearBlur=function(){e.layerBgBlur&&n.target&&n.target.get(0)&&(c.removeLayer(n.VL.attr("id"),"blur"),l.blur.length&&(n.target.removeClass("velocityLayerBlur"),1==l.blur.length?o(t).scrollTop(n.target.attr("winScrollTop")):o(".velocityLayerContainer",n.target).scrollTop(n.target.attr("winScrollTop"))))},n.setHead=function(){var t,a;if(e.showHead){t=e.OKButton.show?'<a href="javascript:;" class="velocityLayerOK">'+e.OKButton.name+"</a>":"",a=e.CancelButton.show?'<a href="javascript:;" class="velocityLayerCancel">'+e.CancelButton.name+"</a>":"";var i='<div class="velocityLayerHead">'+a+'<span class="velocityLayerTitle">'+e.title+"</span>"+t+"</div>";n.CLBoxInner.append(i)}},n.setBody=function(){var t;t='<div class="velocityLayerBody" style="'+(e.showHead?"":"margin: 0px;")+'"><div class="velocityLayerBodyInner"><div class="velocityLayerContainer"></div></div></div>',n.CLBoxInner.append(t)},n.insertTmplDom=function(t){o.tmpl&&o(".velocityLayerContainer",n.VL).empty().height("auto").append(o("#"+e.tmplId).tmpl(e.tmplData)),(e.tmplDom||t)&&o(".velocityLayerContainer",n.VL).empty().height("auto").append(e.tmplDom||t),(e.loadingAutoComplete||t)&&n.VL.addClass("complete")},n.setFoot=function(){},n.setValues=function(){var e,t;t=n.VL.height(),o(".velocityLayerBg,.velocityLayerOutter",n.VL).height(t),e=o(".velocityLayerHead",n.VL).height(),n.CLBodyInner.height(t-e),o(".velocityLayerContainer",n.VL).css({paddingBottom:"50px"})},n.show=function(){n.VL.show(),setTimeout(function(){n.setBlur(),n.CLOutter.velocity(e.effectClass.In)},150)},n.hide=function(){n.VL.hide(),n.CLOutter.velocity(e.effectClass.Out),n.VL.delay(e.delayTime,"form").queue("form",function(t){e.hide?n.VL.hide():n.VL.remove(),t()}).dequeue("form")},n.close=function(t){t&&n.VL.hide(),n.CLOutter.velocity(e.effectClass.Out),n.VL.delay(e.delayTime,"form").queue("form",function(t){e.hide?n.VL.hide():n.VL.remove(),n.clearBlur(),t()}).dequeue("form")},n.onEvents=function(){n.VL.unbind().bind("click",function(e){}).bind("touchmove",function(e){e.stopPropagation()}),n.onClose(),n.onOK()},n.onClose=function(){n.CLCancel.unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault(),n.doClose()})},n.doClose=function(){e.CloseFun&&e.CloseFun instanceof Function&&e.CloseFun(this),e.CancelFun&&e.CancelFun instanceof Function&&e.CancelFun(this),n.close()},n.onOK=function(){n.CLOK.unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault(),n.doOK()})},n.doOK=function(){e.OKFun&&e.OKFun instanceof Function&&e.OKFun(this)&&n.close()},n.autoClear=function(){}};r.form=function(e){var t={type:"form",no_padding:!1,globalClass:r.prefix+"form",layerBgColor:"#ffffff",effectClass:{In:"transition.bounceInRight",Out:"transition.bounceOutRight"},OKButton:{name:"保存",show:!0},CancelButton:{name:"取消",show:!0}};e&&o.extend(t,e);var n=new u(t);return n.initialize(),n},r.alert=function(e,t,n){if(!e)return void(n&&n instanceof Function&&n());var a={type:"alert",no_padding:!1,globalClass:r.prefix+"alert",layerBgBlur:!1,loading:!1,boxBg:!0,boxBgBlur:!0,boxBgColor:"rgba(255, 255, 255, 0.95)",effectClass:{In:"transition.bounceIn",Out:"transition.fadeOut"},OKButton:{name:"好",show:!0}},i=new u(a);return o.extend(i,{insertTmplDom:function(){},setHead:function(){},setBody:function(){var t;t='<div class="velocityLayerBody"><div class="velocityLayerBodyInner"><div class="velocityLayerContainer">'+e+"</div></div></div>",i.CLBoxInner.append(t)},setFoot:function(){var e;e='<div class="velocityLayerFoot"><div class="velocityLayerFootInner"><a href="javascript:;" class="velocityLayerOK">好</a></div></div>',i.CLBoxInner.append(e)},setValues:function(){i.CLOutter.height(i.CLBoxInner.height())},doOK:function(){i.close()},close:function(e){e&&i.VL.hide(),i.CLOutter.velocity(a.effectClass.Out),e||i.clearBlur(),i.VL.delay(a.delayTime,"alert").queue("alert",function(e){i.VL.remove(),n&&n instanceof Function&&n(),e()}).dequeue("alert")},autoClear:function(){setTimeout(function(){i.close()},3e3)}}),i.initialize(),i},r.confirm=function(e){var t={title:"确认提示",msg:"真的要执行该操作？",type:"confirm",no_padding:!1,globalClass:r.prefix+"confirm",layerBgBlur:!1,loading:!1,boxBg:!0,boxBgBlur:!0,boxBgColor:"rgba(255, 255, 255, 0.95)",effectClass:{In:"transition.bounceIn",Out:"transition.fadeOut"},OKButton:{name:"好",show:!0},CancelButton:{name:"取消",show:!0}};e&&o.extend(t,e);var n=new u(t);return o.extend(n,{insertTmplDom:function(){},setHead:function(){var e;t.title?(e='<div class="velocityLayerHead">'+t.title+"</div>",n.VL.addClass("title")):e="",n.CLBoxInner.append(e)},setBody:function(){var e;e='<div class="velocityLayerBody"><div class="velocityLayerBodyInner"><div class="velocityLayerContainer">'+t.msg+"</div></div></div>",n.CLBoxInner.append(e)},setFoot:function(){var e;e='<div class="velocityLayerFoot"><div class="velocityLayerFootInner"><a href="javascript:;" class="velocityLayerCancel">取消</a><a href="javascript:;" class="velocityLayerOK">好</a></div></div>',n.CLBoxInner.append(e)},setValues:function(){n.CLOutter.height(n.CLBoxInner.height())}}),n.initialize(),n},r.confirm1=function(e){var t={title:"温馨提示",msg:"不存在此地址",type:"confirm",no_padding:!1,globalClass:r.prefix+"confirm",layerBgBlur:!1,loading:!1,boxBg:!0,boxBgBlur:!0,boxBgColor:"rgba(255, 255, 255, 0.95)",effectClass:{In:"transition.bounceIn",Out:"transition.fadeOut"},OKButton:{name:"确定",show:!0}};e&&o.extend(t,e);var n=new u(t);return o.extend(n,{insertTmplDom:function(){},setHead:function(){var e;t.title?(e='<div class="velocityLayerHead">'+t.title+"</div>",n.VL.addClass("title")):e="",n.CLBoxInner.append(e)},setBody:function(){var e;e='<div class="velocityLayerBody"><div class="velocityLayerBodyInner"><div class="velocityLayerContainer">'+t.msg+"</div></div></div>",n.CLBoxInner.append(e)},setFoot:function(){var e;e='<div class="velocityLayerFoot"><div class="velocityLayerFootInner"><a href="javascript:;" class="velocityLayerCancel">确定</a></div></div>',n.CLBoxInner.append(e)},setValues:function(){n.CLOutter.height(n.CLBoxInner.height())}}),n.initialize(),n},r.tip=function(e,t){if(e){var n={type:"tip",no_padding:!1,globalClass:r.prefix+"tip",layerBg:!1,layerBgBlur:!1,loading:!1,boxBg:!0,boxBgBlur:!0,layerHeight:!1,unique:!0,boxBgColor:"rgba(0, 0, 0, 0.75)",effectClass:{In:"transition.bounceInDown",Out:"transition.bounceOutUp"},time:t||3e3},a=new u(n);return o.extend(a,{insertTmplDom:function(){},setBlur:function(){},setHead:function(){var t;t='<div class="velocityLayerHead">'+e+"</div>",a.CLBoxInner.append(t)},setBody:function(){},setFoot:function(){},setValues:function(){a.CLOutter.height(a.CLBoxInner.height())},doOK:function(){a.close()},close:function(e){e&&a.VL.hide(),a.CLOutter.velocity(n.effectClass.Out),e||a.clearBlur(),a.VL.delay(n.delayTime,"tip").queue("tip",function(e){a.VL.remove(),e()}).dequeue("tip")},autoClear:function(){setTimeout(function(){a.close()},n.time)}}),a.initialize(),a}},r.goods=function(e){var t={type:"goods",no_padding:!1,globalClass:r.prefix+"goods",layerBgColor:"rgba(255, 255, 255, 1.80)",effectClass:{In:"transition.bounceInRight",Out:"transition.bounceOutRight"},OKButton:{name:"添加",show:!0},CancelButton:{name:"返回",show:!0}};e&&o.extend(t,e);var n=new u(t);return o.extend(n,{setHead:function(){var e;e=t.title?'<div class="velocityLayerHead"><a href="javascript:;" class="velocityLayerCancel">'+t.CancelButton.name+'</a><span class="velocityLayerTitle">'+t.title+"</span></div>":"",n.CLBoxInner.append(e)},setFoot:function(){}}),n.initialize(),n},r.cart=function(e){var t={type:"cart",no_padding:!1,globalClass:r.prefix+"cart",layerBgColor:"rgba(255, 255, 255, 1.80)",effectClass:{In:"transition.bounceInUp",Out:"transition.bounceOutDown"},OKButton:{name:"添加",show:!0},CancelButton:{name:"返回",show:!0}};e&&o.extend(t,e);var n=new u(t);return o.extend(n,{setHead:function(){var e;e=t.title?'<div class="velocityLayerHead"><a href="javascript:;" class="velocityLayerCancel">'+t.CancelButton.name+'</a><span class="velocityLayerTitle">'+t.title+'</span><a href="javascript:;" class="velocityLayerOK">'+t.OKButton.name+"</a></div>":"",n.CLBoxInner.append(e)},setFoot:function(){}}),n.initialize(),n},r.ImageCrop=function(e){var t={type:"ImageCrop",no_padding:!1,globalClass:r.prefix+"ImageCrop",layerBgColor:"rgba(0, 0, 0, 1)",effectClass:{In:"transition.bounceInUp",Out:"transition.bounceOutDown"},OKButton:{name:"选取",show:!0},CancelButton:{name:"取消",show:!0}};e&&o.extend(t,e);var n=new u(t);return o.extend(n,{setHead:function(){},setFoot:function(){var e;e='<div class="velocityLayerFoot"><a class="velocityLayerOK" href="javascript:;">'+t.OKButton.name+'</a><div class="velocityLayerOpeBox"><a class="rotate-btn" id="rotate-btn">方向旋转</a></div><a class="velocityLayerCancel" href="javascript:;">'+t.CancelButton.name+"</a></div>",n.CLBoxInner.append(e)}}),n.initialize(),n},r.ImageCropTip=function(e,t,n){if(e){var a={type:"ImageCropTip",no_padding:!1,globalClass:r.prefix+"ImageCropTip",layerBg:!1,layerBgBlur:!1,boxBg:!0,boxBgBlur:!0,layerHeight:!1,unique:!0,boxBgColor:"rgba(0, 0, 0, 0)",tipImage:t,effectClass:{In:"transition.bounceInDown",Out:"transition.bounceOutUp"},OKButton:{name:"选取",show:!0},CancelButton:{name:"取消",show:!0},time:n||5e3},i=new u(a);return o.extend(i,{setBlur:function(){},setHead:function(){},setBody:function(){var t;t='<div class="ImageCropTip-container"><div class="ImageCropTip-container-inner"><div class="ImageCropTip-content">'+(a.tipImage?'<div class="ImageCropTip-image"><img src="'+a.tipImage+'" /></div>':"")+'<div class="ImageCropTip-text">'+e+'</div><a class="velocityLayerCancel" href="javascript:;">'+a.CancelButton.name+"</a></div></div></div>",i.CLBoxInner.append(t)},setFoot:function(){},setValues:function(){i.CLOutter.height(i.CLBoxInner.height())},doOK:function(){i.close()},close:function(e){e&&i.VL.hide(),i.CLOutter.velocity(a.effectClass.Out),e||i.clearBlur(),i.VL.delay(a.delayTime,"ImageCropTip").queue("ImageCropTip",function(e){i.VL.remove(),e()}).dequeue("ImageCropTip")},autoClear:function(){setTimeout(function(){i.close()},a.time)}}),i.initialize(),i}},r.pay=function(e){var t={title:"选择支付方式",type:"Pay",no_padding:!1,globalClass:r.prefix+"Pay",layerBgColor:"rgba(255, 255, 255, 1.80)",effectClass:{In:"transition.bounceInUp",Out:"transition.bounceOutDown"},OKButton:{name:"立即支付",show:!0},CancelButton:{name:"取消",show:!0}};e&&o.extend(t,e);var n=new u(t);return o.extend(n,{setHead:function(){var e;e=t.title?'<div class="velocityLayerHead"><span class="velocityLayerTitle">'+t.title+'</span><a href="javascript:;" class="velocityLayerCancel">'+t.CancelButton.name+"</a></div>":"",n.CLBoxInner.append(e)},setFoot:function(){var e;e='<div class="velocityLayerFoot"><div class="velocityLayerFootInner"><a href="javascript:;" class="velocityLayerOK disabled">'+t.OKButton.name+"</a></div></div>",n.CLBoxInner.append(e)},setValues:function(){var e,t,a;t=n.VL.height(),e=o(".velocityLayerHead",n.VL).height(),a=o(".velocityLayerFoot",n.VL).height(),n.CLBodyInner.height(t-e-a)}}),n.initialize(),n},r.iframe=function(e,t){if(t){var n={title:"支付宝支付",type:"Iframe",no_padding:!1,globalClass:r.prefix+"Iframe",layerBgColor:"rgba(255, 255, 255, 1.80)",effectClass:{In:"transition.bounceInUp",Out:"transition.bounceOutDown"},CancelButton:{name:"关闭",show:!0}};e&&o.extend(n,e);var a=new u(n);return o.extend(a,{insertTmplDom:function(){},setHead:function(){var e;e=n.title?'<div class="velocityLayerHead"><span class="velocityLayerTitle">'+n.title+'</span><a href="javascript:;" class="velocityLayerCancel">'+n.CancelButton.name+"</a></div>":"",a.CLBoxInner.append(e)},setBody:function(){var e;e='<div class="velocityLayerBody" style="'+(n.showHead?"":"margin: 0px;")+'"><div class="velocityLayerBodyInner"><div class="Iframe-container"><iframe src="'+t+'" /></div></div></div>',a.CLBoxInner.append(e)},setValues:function(){var e,t;t=a.VL.height(),e=o(".velocityLayerHead",a.VL).height(),a.CLBodyInner.height(t-e)}}),a.initialize(),a}},r.empty=function(e){var t={type:"Empty",no_padding:!1,globalClass:r.prefix+"Empty",layerBgColor:"rgba(0, 0, 0, 0.80)",effectClass:{In:"transition.bounceInUp",Out:"transition.bounceOutDown"}};e&&o.extend(t,e);var n=new u(t);return o.extend(n,{setHead:function(){},setValues:function(){n.CLBodyInner.height(n.VL.height())}}),n.initialize(),n};return e.VelocityLayer=r,r}(window.jQuery||window.Zepto||window,window,document)});